import{_ as A}from"./Badge.b694092e.js";import{_ as E}from"./NCodeBlock.vue.f41a0d29.js";import{am as q,an as G,D as x,C as k,a as K,X as L,ao as M,ap as W,o as f,f as y,L as X,u as e,i as n,w as d,F as B,t as D,y as R,c as z,h as v,K as I,l as _,k as H,aq as J}from"./entry.e1ce6ad4.js";import{_ as O}from"./NCheckbox.vue.f03c4497.js";import{_ as Q}from"./NTip.vue.2f192405.js";const N=new Map;function Y(t,a){const l=t;return N.has(l)||N.set(l,Z(t,a)),N.get(l)}function Z(t,a){const l=q(),u=G(`npm:check:${t}`,()=>k.checkForUpdateFor(t)).data,i=x("idle"),c=x();l.hook("devtools:terminal:exit",({id:s,code:o})=>{s!==c||!c||(i.value=o===0?"updated":"idle")});async function C(s){if(i.value!=="idle")return;const o=await k.getNpmCommand("update",t,a);if(o&&await s(o.join(" ")))return i.value="running",c.value=(await k.runNpmCommand("update",t,a))?.processId,c.value}async function h(){i.value==="updated"&&await k.restartNuxt()}return{info:u,state:i,update:C,restart:h,processId:c}}const ee={key:0},te={p4:"",flex:"~ col gap-1"},ae={class:"text-lg font-medium leading-6"},oe=v("p",{op50:""}," The following command will be executed in your terminal: ",-1),ne={flex:"~ gap-3","justify-end":"",mt2:""},ce=K({__name:"NpmVersionCheck",props:{packageName:null,options:null,showVersion:{type:Boolean,default:!0}},setup(t){const a=t,l=L(),{info:u,update:i,state:c,processId:C,restart:h}=Y(a.packageName,a.options),s=x(!0),o=x(!0),P=M(),w=W();async function $(){const p=await i(async r=>w.start(r));p&&o.value&&P.value.push({id:p,message:`${a.packageName} has been updated. Do you want to restart the Nuxt server now?`}),p&&s.value&&l.push(`/modules/terminals?id=${encodeURIComponent(p)}`)}return(p,r)=>{const b=A,T=E,V=O,F=Q,U=H,j=J;return f(),y(B,null,[X(p.$slots,"default",{id:e(C),info:e(u),update:$,state:e(c),restart:e(h)},()=>[e(u)&&t.showVersion?(f(),y("code",ee,D(`v${e(u).current}`),1)):R("",!0),e(u)?.latest?(f(),y(B,{key:1},[e(u).needsUpdate?(f(),y("button",{key:0,onClick:r[0]||(r[0]=g=>$())},[n(b,{"bg-green-400:10":"","text-green-400":"",title:"updates available",textContent:"updates available"})])):(f(),z(b,{key:1,"bg-gray-400:10":"","text-gray-400":"",title:"latest",textContent:"latest"}))],64)):R("",!0)]),n(e(w),null,{default:d(({resolve:g,args:S})=>[n(j,{"model-value":!0,onClose:m=>g(!1)},{default:d(()=>[v("div",te,[v("h3",ae," Update "+D(a.packageName)+"? ",1),oe,n(T,{code:S[0],lang:"bash",px4:"",py2:"",my3:"",border:"~ base rounded",lines:!1},null,8,["code"]),n(V,{modelValue:e(s),"onUpdate:modelValue":r[1]||(r[1]=m=>I(s)?s.value=m:null),n:"primary"},{default:d(()=>[_(" Navigate to terminal ")]),_:1},8,["modelValue"]),n(V,{modelValue:e(o),"onUpdate:modelValue":r[2]||(r[2]=m=>I(o)?o.value=m:null),n:"primary"},{default:d(()=>[_(" Restart Nuxt server after update ")]),_:1},8,["modelValue"]),v("div",ne,[n(F,{n:"sm purple","flex-auto":"",icon:"carbon-chemistry"},{default:d(()=>[_(" Experimental feature. Please make sure to backup your project first. ")]),_:1}),n(U,{onClick:m=>g(!1)},{default:d(()=>[_(" Cancel ")]),_:2},1032,["onClick"]),n(U,{n:"solid primary",onClick:m=>g(!0)},{default:d(()=>[_(" Update ")]),_:2},1032,["onClick"])])])]),_:2},1032,["onClose"])]),_:1})],64)}}});export{ce as _};
