import{_ as ae}from"./NIconButton.vue.8aefaa88.js";import{_ as se}from"./NSelect.vue.bd089297.js";import{_ as re}from"./NTextInput.vue.188f5529.js";import{a as F,o as r,c as y,w as d,a3 as H,Z as le,u as t,ah as P,L as ue,am as ie,X as ce,D as I,m as j,a9 as A,af as R,a7 as de,T as me,r as pe,e as fe,C as p,f as u,h as l,l as c,i as m,F as b,v as L,an as T,t as v,K as D,x as E,ax as q,y as z,aC as _e,aD as ve,aH as ye,as as ge,H as he,k as ke,aI as xe}from"./entry.e1ce6ad4.js";import{_ as be}from"./PanelLeftRight.vue.73b30819.js";const we=F({__name:"NLink",props:{to:null,href:null,target:null},setup(w){return(i,g)=>(r(),y(le(w.href||w.target?"a":t(P)),H(i.$props,{class:"n-transition n-link n-link-base hover:n-link-hover"}),{default:d(()=>[ue(i.$slots,"default")]),_:3},16))}}),Ce={class:"items-center flex justify-between px-3 h-[48px] gap1"},Ke={class:"w-full text-sm"},Ve=["value"],Ne=l("div",{"x-divider":""},null,-1),$e={key:0,"h-full":"","of-hidden":"",flex:"~ col"},Se={border:"b base",class:"text-sm flex items-center justify-between flex-none px-4 h-[49px]"},Ie={class:"flex items-center gap-4"},je={key:1},Le=["onKeyup"],De={key:1,flex:"","items-center":"",op50:"","h-full":"","justify-center":"","text-center":""},qe=l("br",null,null,-1),Ue={key:1,grid:"~",class:"h-full of-hidden"},Be={class:"flex gap-4 justify-center op50 text-center flex-col"},Me={key:0},Ae={key:1},Re=l("code",null,"nitro.storage",-1),Te=l("br",null,null,-1),Ee={class:"mx-auto"},ze={class:"font-bold"},Fe=l("br",null,null,-1),He={class:"text-sm"},Pe=l("br",null,null,-1),Oe={key:0,class:"font-mono text-xs"},Ye=F({__name:"storage",async setup(w){let i,g;const O=ie(),h=ce(),k=I(""),_=I(""),a=j({get(){return A().query?.storage},set(n){h.replace({query:{storage:n}})}}),e=I(),x=j(()=>A().query?.key),{data:C}=([i,g]=R(()=>T("storageMounts",()=>p.getStorageMounts())),i=await i,g(),i),{data:K,refresh:U}=([i,g]=R(async()=>T("storageKeys",async()=>a.value?await p.getStorageKeys(a.value):[])),i=await i,g(),i),W=O.hook("storage:key:update",async(n,s)=>{if(!(!a.value||n.split(":")[0]!==a.value)&&(await U(),x.value===n)){if(s==="remove")return h.replace({query:{storage:a.value}});await N(x.value)}});de(W),me(a,U),pe(async()=>{if(!x.value){e.value=null;return}N(x.value)}),fe("keydown",n=>{n.key==="s"&&(n.ctrlKey||n.metaKey)&&($(),n.preventDefault())});function V(n){return n.replace(`${a.value}:`,"")}const X=j(()=>K.value?K.value.filter(n=>n.includes(k.value)):[]);async function N(n){const s=await p.getStorageItem(n);e.value={key:n,updatedKey:V(n),editingKey:!1,content:s,updatedContent:s}}async function Z(){if(!_.value||!a.value)return;const n=`${a.value}:${_.value}`;K.value?.includes(n)||await p.setStorageItem(n,""),h.replace({query:{storage:a.value,key:n}}),_.value=""}async function $(){e.value&&(await p.setStorageItem(e.value.key,e.value.updatedContent),await N(e.value.key))}async function G(){!e.value||!a.value||(await p.removeStorageItem(e.value.key),e.value=null)}async function J(){if(!e.value||!a.value)return;const n=`${a.value}:${e.value.updatedKey}`;await p.setStorageItem(n,e.value.updatedContent),await p.removeStorageItem(e.value.key),h.replace({query:{storage:a.value,key:n}})}return(n,s)=>{const Q=ae,Y=se,S=re,ee=P,te=he,B=ke,M=we,ne=be,oe=xe;return t(a)?(r(),y(ne,{key:0,"storage-key":"tab-storage"},{left:d(()=>[l("div",Ce,[m(Q,{icon:"carbon-chevron-left","ml--1":"",onClick:s[0]||(s[0]=o=>a.value="")}),l("div",Ke,[m(Y,{modelValue:t(a),"onUpdate:modelValue":s[1]||(s[1]=o=>D(a)?a.value=o:null),n:"primary",icon:"carbon-data-base"},{default:d(()=>[(r(!0),u(b,null,L(t(C),(o,f)=>(r(),u("option",{key:f,value:f},v(f),9,Ve))),128))]),_:1},8,["modelValue"])])]),m(S,{modelValue:t(k),"onUpdate:modelValue":s[2]||(s[2]=o=>D(k)?k.value=o:null),icon:"carbon-search",placeholder:"Search...",n:"primary sm",border:"y x-none base! rounded-0",class:"w-full py2 ring-0!"},null,8,["modelValue"]),(r(!0),u(b,null,L(t(X),o=>(r(),u(b,{key:o},[m(ee,{"text-sm":"",px2:"",py1:"","font-mono":"",block:"",truncate:"",to:{query:{key:o,storage:t(a)}},class:E(o===t(e)?.key?"text-primary n-bg-active":"text-secondary hover:n-bg-hover")},{default:d(()=>[c(v(V(o)),1)]),_:2},1032,["to","class"]),Ne],64))),128)),m(S,{modelValue:t(_),"onUpdate:modelValue":s[3]||(s[3]=o=>D(_)?_.value=o:null),icon:"carbon-add",placeholder:"key",n:"sm",border:"t-none x-none base! rounded-0",class:"w-full py2 ring-0! font-mono",onKeyup:q(Z,["enter"])},null,8,["modelValue","onKeyup"])]),right:d(()=>[t(e)?.key?(r(),u("div",$e,[l("div",Se,[l("div",Ie,[t(e).editingKey?(r(),y(S,{key:0,modelValue:t(e).updatedKey,"onUpdate:modelValue":s[4]||(s[4]=o=>t(e).updatedKey=o),onKeyup:q(J,["enter"])},null,8,["modelValue","onKeyup"])):(r(),u("code",je,[c(v(V(t(e).key))+" ",1),m(te,{icon:"carbon-edit",class:"op50 cursor-pointer hover:op100",onClick:s[5]||(s[5]=o=>t(e).editingKey=!0)})])),t(e).editingKey?z("",!0):(r(),y(B,{key:2,n:"green xs",disabled:t(e).content===t(e).updatedContent,class:E({"border-green":t(e).content!==t(e).updatedContent}),onClick:$},{default:d(()=>[c(" Save ")]),_:1},8,["disabled","class"]))]),l("div",null,[m(B,{n:"red xs",onClick:G},{default:d(()=>[c(" Delete ")]),_:1})])]),typeof t(e).content=="object"?(r(),y(t(_e),H({key:0,modelValue:t(e).updatedContent,"onUpdate:modelValue":s[6]||(s[6]=o=>t(e).updatedContent=o),class:[[n.$colorMode.value==="dark"?"jse-theme-dark":"light"],"h-full text-sm json-editor-vue of-auto outline-none"]},n.$attrs,{mode:"text","navigation-bar":!1,indentation:2,"tab-size":2}),null,16,["modelValue","class"])):ve((r(),u("textarea",{key:1,"onUpdate:modelValue":s[7]||(s[7]=o=>t(e).updatedContent=o),placeholder:"Item value...",class:"of-auto h-full text-sm outline-none font-mono p-4",onKeyup:q(ge($,["ctrl"]),["enter"])},null,40,Le)),[[ye,t(e).updatedContent]])])):(r(),u("div",De,[l("p",null,[c(" Select one key to start."),qe,c("Learn more about "),m(M,{href:"https://nitro.unjs.io/guide/introduction/storage",n:"orange",target:"_blank"},{default:d(()=>[c(" Nitro storage ")]),_:1})])]))]),_:1})):(r(),u("div",Ue,[l("div",Be,[Object.keys(t(C)).length?(r(),u("p",Me," Select one storage to start: ")):(r(),u("p",Ae,[c(" No custom storage defined in "),Re,c("."),Te,c(" Learn more about "),m(M,{href:"https://nitro.unjs.io/guide/storage",n:"orange",target:"_blank"},{default:d(()=>[c(" Nitro storage ")]),_:1})])),l("div",Ee,[(r(!0),u(b,null,L(t(C),(o,f)=>(r(),y(oe,{key:f,class:"p-4 cursor-pointer text-left border mb-4 hover:border-green",onClick:We=>a.value=f},{default:d(()=>[l("span",ze,v(f),1),Fe,l("span",He,v(o.driver)+" driver",1),Pe,o.base?(r(),u("span",Oe,v(o.base),1)):z("",!0)]),_:2},1032,["onClick"]))),128))])])]))}}});export{Ye as default};
